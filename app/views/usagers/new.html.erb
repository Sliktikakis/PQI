<script>
var val_stock_nom = "zzz";
var val_stock_prenom = "zzz";
var val_nom = "zzz";
var val_prenom = "zzz";
var alerted = false;

$(document).ready(function(){
    $("#submit").mouseenter(function(){
        val_nom = new RegExp('^' + $("#usager_nom").val() + '$', "i");
       	val_prenom = new RegExp('^' + $("#usager_prenom").val() + '$', "i");
       	if (val_stock_nom != $("#usager_nom").val() || val_stock_prenom != $("#usager_prenom").val()) {
       		alerted = false;
       	}
        if (alerted == false && ["Inconnu", "Inconnue", "Inconnu(e)"].indexOf($("#usager_prenom").val()) == -1) {
	        for (i = 0; i < gon.noms.length; i++) {
	           	if (gon.noms[i].toString().match(val_nom) && gon.prenoms[i].toString().match(val_prenom)) {
	            	alert("Etes-vous sûr(e) ? Un usager possédant les mêmes nom et prénom est déjà répertorié.");
	            	alerted = true;
	            	val_stock_nom = $("#usager_nom").val();
	            	val_stock_prenom = $("#usager_prenom").val();
	            	break;
	            };
	        };
        };
    });
});
</script>

<% provide(:title, 'Nouvel usager') %>
<h1>Nouvel usager</h1>

<div class="row">
  <div class="col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1 col-xs-10 col-xs-offset-1">
    <h4>
      On renseignera au moins le nom ou le prénom de l'usager, ainsi que sa ville et son sexe. Sinon, choisir en bas du formulaire le bouton "Inconnu" (il faut néanmoins renseigner au moins sa ville).<br><br>
      Date de naissance : utiliser le bouton "calendrier"
    </h4>
  </div>
</div>

<div class="row">
  <div class="col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-8 col-xs-offset-2">
    <%= render 'form' %>
  </div>
</div>