<%= simple_form_for(@rencontre) do |f| %>

<% if @usager.rencontres.empty? %>
  <h1>Renseigner la rencontre avec <%= "#{@usager.sexe} #{@usager.nom} #{@usager.prenom}" %></h1>
<% else %>
  <h1>Ajouter une rencontre avec <%= "#{@usager.sexe} #{@usager.nom} #{@usager.prenom}" %></h1>
<% end %>

<% unless session[:groupe] %>
  <div class="row">
    <div class="form-inline col-md-6 col-sm-6 col-xs-6">
      <h3>Date</h3>
      <%= f.input :date, label: false, :as => :date_picker, input_html: {value: Date.today}, class: 'form-control' %>
    </div>
    <div class="col-md-6 col-sm-6 col-xs-6">
      <h3>Type</h3>
      <%= f.select :type_renc, @types, prompt: "Quel type de rencontre ?", class: 'form-control' %>
    </div>
  </div>

  <hr>
<% end %>

<h3>Signalement</h3>

<div class="row form-inline">
  <div class="col-md-6 col-sm-6 col-xs-6">
    <% if @usager.rencontres.empty? %>
      <%= f.label :signale, "Non connu(e) du service avant" %>
    <% else %>  
      <%= f.label :signale, "Nouveau signalement" %>
    <% end %>

    <%= f.check_box :signale, class: 'form-control check' %>
  </div>

  <div class="col-md-6 col-sm-6 col-xs-6 appear">
    <%= f.label :signalement, "Type" %>

    <% if @usager.rencontres.empty? %>
      <%= f.select :signalement,  @signalements,
                                  prompt: "Quel type de signalement ?",
                                  class: 'form-control' %>
    <% else %>
      <%= f.select :signalement,	[	["Signalement 115", "Signalement 115"],
                        				  ["Signalement tiers", "Signalement tiers"]],
                        			    prompt: "Quel type de signalement ?",
                        			    class: 'form-control' %>
    <% end %>
  </div>
</div>

<hr>

<h3>Accompagnement</h3>

<div class="row form-inline">
  <div class="col-md-6 col-sm-6 col-xs-6">
    <%= f.label :accomp, "Accompagnement" %>
    <%= f.check_box :accomp, checked: false, class: 'form-control check' %>
  </div>

  <div class="col-md-6 col-sm-6 col-xs-6 appear">
    <%= f.label :type_accomp, "Type" %>
    <%= f.select :type_accomp, @accomps, prompt: "Quel type d'accompagnement ?", class: 'form-control' %>
  </div>
</div>

<hr>

<h3>Options</h3>

<div class="form-inline">
  <%= f.label :dnv, "Maraude déplacée mais personne non vue" %>
  <%= f.check_box :dnv, checked: false, class: 'form-control' %>
</div>

<div class="form-inline">
  <%= f.label :prev, "Rencontre prévisionnelle" %>
  <%= f.check_box :prev, checked: false, class: 'form-control' %>

  <hr>
</div>

<h3>Détails</h3>

  <%= f.text_area :details, class: 'form-control', html: {style: 'text-align:center'}, rows: 10 %>

<% if @usager.enfants.any? %>
  <br><%= f.label :nb_enf, "Nombre d'enfants vus" %>
  <%= f.select :nb_enf, @nb_enf, class: 'form-control' %><br>
<% end %>

  <hr>

<h3>Prestations</h3>

<div>
  <% for presta in @prestas do %>
    <%= f.check_box :prestas, { :multiple => true }, "#{presta.first}" %>
    <%= presta.first %><br>
  <% end %>

  <hr>
</div>

<div class="btn-group">
  <%= f.submit "Valider la rencontre", class: 'btn btn-primary', id: 'submit' %>

  <% if !@usager.rencontres %>
    <button type="button" class="btn btn-danger">
      <%= link_to "Pas besoin", usagers_path, id: 'no-styling' %>
    </button>
  <% end %>
</div>

<% end %>